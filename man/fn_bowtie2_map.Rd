% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fn_bowtie2_map.R
\name{fn_bowtie2_map}
\alias{fn_bowtie2_map}
\title{Map Reads with Bowtie2}
\usage{
fn_bowtie2_map(
  fq1,
  fq2 = NULL,
  index,
  base.name,
  output.dir = "db/bowtie2/",
  suffix = "",
  save.unmapped = TRUE,
  global = TRUE,
  cores = 8,
  mapq = NULL,
  max.ins = NULL,
  multimapper.mode = "best",
  alignment.stats.output.dir = output.dir
)
}
\arguments{
\item{fq1}{Character vector of R1 FASTQ files.}

\item{fq2}{Character vector of R2 FASTQ files. Can be NULL for single-end mapping.}

\item{index}{Path to Bowtie2 index prefix.}

\item{base.name}{Base name for output files (BAM, stats, unmapped). Overrides fq filenames.}

\item{output.dir}{Directory for BAM and unmapped FASTQ. Default: 'db/bowtie2/'.}

\item{suffix}{Suffix to append to output file names (e.g., '_spikein', '_genome'). Default: ''.}

\item{save.unmapped}{Logical. If TRUE, writes unmapped reads. Default TRUE.}

\item{global}{Logical. If TRUE (default), performs end-to-end alignment; if FALSE, local alignment.}

\item{cores}{Total number of threads to use. Default 8.}

\item{mapq}{Optional minimum MAPQ to filter alignments. Default NULL (no filtering).}

\item{max.ins}{Optional maximum insert size for paired-end reads. Default NULL (Bowtie2 default).}

\item{multimapper.mode}{How to handle multi-mappers: "best" (default, report best/random), "all" (report all up to -k), or "unique" (only unique mappers).}

\item{alignment.stats.output.dir}{Optional directory for Bowtie2 alignment stats. Defaults to output.dir.}
}
\value{
A data.table with columns: fq1_in, fq2_in, bam, stats, fq1_unmapped, fq2_unmapped, cmd, job.name.
}
\description{
Maps reads to a reference index using Bowtie2.
Converts mapped reads to a sorted BAM file.
Preserves UMIs in read headers.
Optionally filters by MAPQ, sets max insert size, and writes unmapped reads.
}
