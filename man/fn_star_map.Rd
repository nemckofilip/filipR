% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fn_star_map.R
\name{fn_star_map}
\alias{fn_star_map}
\title{Map Reads with STAR (Single-End or Paired-End)}
\usage{
fn_star_map(
  fq1,
  fq2 = NULL,
  index,
  base.name,
  output.dir = "db/bam/",
  save.unmapped = TRUE,
  cores = 8,
  mapq = NULL,
  outFilterMultimapNmax = 10,
  outFilterMismatchNmax = 6,
  multimapper.mode = "best",
  alignment.stats.output.dir = "db/alignment_stats/"
)
}
\arguments{
\item{fq1}{Character string. Path to R1 FASTQ file.}

\item{fq2}{Character string. Path to R2 FASTQ file. Default NULL (single-end).}

\item{index}{Path to STAR genome index directory.}

\item{base.name}{Base name for output files.}

\item{output.dir}{Directory for BAM and unmapped FASTQ. Default: 'db/bam/'.}

\item{save.unmapped}{Logical. If TRUE, writes unmapped reads. Default TRUE.}

\item{cores}{Total number of threads to use. Default 8.}

\item{mapq}{Optional minimum MAPQ to filter alignments. Default NULL.}

\item{outFilterMultimapNmax}{Maximum number of loci a read can map to. Default 10.}

\item{outFilterMismatchNmax}{Maximum number of mismatches per read. Default 6.}

\item{multimapper.mode}{How to handle multi-mappers: "best" (default, random assignment, output 1), "all" (output all alignments), or "unique" (only unique mappers).}

\item{alignment.stats.output.dir}{Optional directory for STAR log files. Default: 'db/alignment_stats/'.}
}
\value{
A data.table with columns: fq1_in, fq2_in, bam, stats, fq1_unmapped, fq2_unmapped, cmd, job.name.
}
\description{
Maps reads to a reference genome using STAR.
Converts mapped reads to a sorted BAM file.
Preserves UMIs in read headers.
}
