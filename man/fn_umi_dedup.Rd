% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fn_umi_dedup.R
\name{fn_umi_dedup}
\alias{fn_umi_dedup}
\title{Deduplicate Reads using UMI-tools}
\usage{
fn_umi_dedup(
  bam,
  base.name,
  output.dir = "db/bam_dedup/",
  stats.dir = "db/umi_stats/",
  umi_separator = "_",
  paired = NULL,
  cores = 4
)
}
\arguments{
\item{bam}{Character string. Path to the sorted BAM file.}

\item{base.name}{Base name for output files.}

\item{output.dir}{Directory for deduplicated BAMs. Default: 'db/bam_dedup/'.}

\item{stats.dir}{Directory for UMI stats. Default: 'db/umi_stats/'.}

\item{umi_separator}{The character separating the Read ID from the UMI. Default '_'.}

\item{paired}{Logical. If TRUE, use paired-end mode. If FALSE, single-end. If NULL (default), auto-detect from BAM.}

\item{cores}{Number of threads. Used for the temporary indexing step.}
}
\value{
A data.table with columns: bam_in, bam_dedup, stats, cmd, job.name.
}
\description{
Removes PCR duplicates using UMI-tools.
Assumes UMIs are in the read header (read_id).
Requires the input BAM to be sorted.
Automatically creates a temporary index (.bai) if one is missing, then deletes it.
Automatically detects paired-end vs single-end from the BAM file.
}
